# TTestCheck项目分析
## 项目功能
TTestCheck是一个自动化测试监控工具，主要功能包括：

1. 屏幕状态监控 ：通过图像识别技术（使用pyautogui库）持续监控电脑屏幕上的测试界面状态，识别三种关键状态：
   
   - 测试通过（pass）
   - 测试失败（fail）
   - 就绪状态（ready/front）
2. PLC通信 ：与可编程逻辑控制器(PLC)建立TCP连接，根据屏幕状态向PLC发送相应的控制命令
3. 心跳检测 ：通过独立线程实现与PLC的心跳通信，确保连接持续有效
4. 配置管理 ：支持保存和加载用户设置（IP地址和设备ID）
5. 自动化操作 ：当检测到pass或fail状态时，自动执行回车操作
## 项目流程
1. 初始化阶段 ：
   
   - 加载settings.json配置文件，获取默认PLC IP地址和设备ID
   - 通过GUI提示用户确认或修改PLC IP地址和设备ID（T1/T2/D1/D2/NFC）
   - 保存用户输入的设置到配置文件
   - 初始化colorama库以实现控制台彩色输出
2. 线程启动 ：
   
   - 启动心跳线程（heartBeat）：定期与PLC通信，维持连接状态
   - 启动主监控线程（main）：执行屏幕监控和状态检测
3. 主监控循环 ：
   
   - 使用pyautogui持续搜索屏幕上的关键图像（fail.png, pass.png, front.png）
   - 根据识别结果向PLC发送不同的控制命令：
     - 检测到fail图像：发送失败状态代码，自动按回车
     - 检测到pass图像：发送通过状态代码，自动按回车
     - 检测到front图像：发送就绪状态代码
     - 都未检测到：发送消失状态代码
   - 循环间隔为0.5秒
4. 心跳检测循环 ：
   
   - 定期（每0.5秒）与PLC通信，发送和接收心跳信号
   - 根据接收到的心跳信号（100或200），发送相反的信号以维持通信
## 关键技术点
1. 屏幕图像识别 ：使用pyautogui的locateCenterOnScreen方法，带置信度参数提高识别准确性
2. 多线程 ：使用threading模块实现心跳检测和主监控的并行执行
3. 网络通信 ：使用socket库与PLC建立TCP连接并发送命令
4. 配置持久化 ：通过JSON文件保存和加载用户配置
## 项目应用场景
该项目主要应用于自动化测试环境中，用于监控测试程序的运行状态并与工业控制系统（PLC）进行通信，实现测试流程的自动化控制和状态反馈。
